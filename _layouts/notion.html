<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | Computer Architecture Notes</title>
    <link rel="stylesheet" href="{{ '/assets/css/notion-style.css' | relative_url }}">
    
    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    
    <!-- Improved Syntax highlighting script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Add language labels to code blocks
            document.querySelectorAll('pre code').forEach(function(block) {
                const language = block.className.match(/language-(\w+)/);
                if (language) {
                    block.parentElement.setAttribute('data-lang', language[1]);
                    
                    // Add language class to the code block for styling
                    block.parentElement.classList.add('language-' + language[1]);
                }
                
                // Apply syntax highlighting based on language
                if (block.classList.contains('language-python')) {
                    highlightPython(block);
                } else if (block.classList.contains('language-cpp')) {
                    highlightCpp(block);
                } else {
                    // Generic highlighting
                    highlightGeneric(block);
                }
            });
            
            // Python syntax highlighting
            function highlightPython(block) {
                let html = block.innerHTML;
                
                // Keywords
                const keywords = ['def', 'if', 'else', 'for', 'while', 'in', 'return', 'import', 'from', 'as', 'class', 'try', 'except', 'finally', 'with', 'not', 'and', 'or', 'True', 'False', 'None', 'lambda'];
                keywords.forEach(keyword => {
                    const regex = new RegExp(`\\b${keyword}\\b`, 'g');
                    html = html.replace(regex, `<span class="keyword">${keyword}</span>`);
                });
                
                // Comments
                html = html.replace(/(#.*$)/gm, '<span class="comment">$1</span>');
                
                // Strings
                html = html.replace(/(".*?"|'.*?')/g, '<span class="string">$1</span>');
                
                // Numbers
                html = html.replace(/\b(\d+)\b/g, '<span class="number">$1</span>');
                
                // Function calls
                html = html.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\(/g, '<span class="function">$1</span>(');
                
                block.innerHTML = html;
            }
            
            // C++ syntax highlighting
            function highlightCpp(block) {
                let html = block.innerHTML;
                
                // Keywords
                const keywords = ['if', 'else', 'for', 'while', 'do', 'switch', 'case', 'default', 'break', 'continue', 'return', 'class', 'struct', 'enum', 'union', 'typedef', 'static', 'const', 'public', 'private', 'protected', 'new', 'delete', 'this', 'sizeof', 'true', 'false', 'nullptr', 'void', 'int', 'char', 'bool', 'float', 'double', 'unsigned', 'signed', 'long', 'short'];
                keywords.forEach(keyword => {
                    const regex = new RegExp(`\\b${keyword}\\b`, 'g');
                    html = html.replace(regex, `<span class="keyword">${keyword}</span>`);
                });
                
                // Comments
                html = html.replace(/\/\/(.*?)$/gm, '<span class="comment">//$1</span>');
                html = html.replace(/\/\*([\s\S]*?)\*\//g, '<span class="comment">/*$1*/</span>');
                
                // Strings
                html = html.replace(/(".*?"|'.*?')/g, '<span class="string">$1</span>');
                
                // Numbers
                html = html.replace(/\b(\d+)\b/g, '<span class="number">$1</span>');
                
                // Function calls
                html = html.replace(/\b([a-zA-Z_][a-zA-Z0-9_]*)\(/g, '<span class="function">$1</span>(');
                
                block.innerHTML = html;
            }
            
            // Generic syntax highlighting
            function highlightGeneric(block) {
                let html = block.innerHTML;
                
                // Comments
                html = html.replace(/\/\/(.*?)$/gm, '<span class="comment">//$1</span>');
                html = html.replace(/\/\*([\s\S]*?)\*\//g, '<span class="comment">/*$1*/</span>');
                html = html.replace(/(#.*$)/gm, '<span class="comment">$1</span>');
                
                // Strings
                html = html.replace(/(".*?"|'.*?')/g, '<span class="string">$1</span>');
                
                // Numbers
                html = html.replace(/\b(\d+)\b/g, '<span class="number">$1</span>');
                
                block.innerHTML = html;
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <nav class="sidebar">
            <h2>Contents</h2>
            <ul class="nav-list">
                <!-- Overview Link -->
                <li class="nav-item">
                    <a href="{{ '/os/' | relative_url }}" class="overview-link">Overview</a>
                </li>

                <!-- Computer Architecture -->
                <li class="nav-item">
                    <h3>Computer Architecture</h3>
                    <ul>
                        {% assign arch_posts = site.posts | where: "categories", "computer-architecture" %}
                        {% for post in arch_posts %}
                            <li><a href="{{ post.url | relative_url }}">{{ post.title }}</a></li>
                        {% endfor %}
                    </ul>
                </li>

                <!-- Operating Systems -->
                <li class="nav-item">
                    <h3>Operating Systems</h3>
                    <ul>
                        {% assign os_posts = site.posts | where: "categories", "os" %}
                        {% for post in os_posts %}
                            <li><a href="{{ post.url | relative_url }}">{{ post.title }}</a></li>
                        {% endfor %}
                    </ul>
                </li>
            </ul>
        </nav>
        
        <main class="content">
            {{ content }}
        </main>
    </div>
</body>
</html>